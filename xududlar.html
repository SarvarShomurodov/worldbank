<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta content="width=device-width, initial-scale=1.0" name="viewport" />
		<title>IMRS</title>
		<meta name="description" content="" />
		<meta name="keywords" content="" />

		<!-- Favicons -->
		<link href="assets/img/screen.png" rel="icon" />
		<link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

		<!-- Fonts -->
		<link href="https://fonts.googleapis.com" rel="preconnect" />
		<link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
			rel="stylesheet"
		/>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
		<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
		<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" />
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
		<link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />

		<!-- <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
		  -->
<!-- Excel uchun XLSX Kutubxonasi -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

		<!-- Main CSS File -->
		<link href="assets/css/style.css" rel="stylesheet" />
		<link href="assets/css/main.css" rel="stylesheet" />
	</head>

	<body class="index-page">
		<header id="header" class="header d-flex align-items-center sticky-top">
			<div class="container-fluid container-xl position-relative d-flex align-items-center">
				<a href="index.html" class="">
					<div class="d-flex align-items-center">
						<img id="screen" src="assets/img/screen.png" alt="" />
						<h5 id="h5_width" class="ms-3 text-white">
							Макроиқтисодий ва ҳудудий тадқиқотлар институти
						</h5>
					</div>
				</a>
				<nav id="navmenu" class="navmenu">
					<ul>
						<li class="dropdown">
							<a href="#"><span>УЗБ</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
							<ul>
								<li><a href="#">Deep Dropdown 1</a></li>
								<li><a href="#">Deep Dropdown 2</a></li>
								<li><a href="#">Deep Dropdown 3</a></li>
								<li><a href="#">Deep Dropdown 4</a></li>
								<li><a href="#">Deep Dropdown 5</a></li>
							</ul>
						</li>
						<li>
							<a href="#contact" class=""><i id="icon_link"></i></a>
						</li>
						<li>
							<a href="#portfolio" class=""><i id="icon_facebook" class="fab fa-facebook"></i></a>
						</li>
						<li>
							<a href="#portfolio" class=""><i id="icon_twiter" class="fab fa-twitter"></i></a>
						</li>
						<li>
							<a href="#portfolio" class=""><i id="icon_link" class="fab fa-linkedin"></i></a>
						</li>
						<li>
							<a href="#contact" class=""><i id="icon_link"></i></a>
						</li>
						<li>
							<a href="#contact" class=""><i id="icon_link" class="fas fa-search"></i></a>
						</li>
					</ul>
					<i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
				</nav>
			</div>
		</header>

		<main class="main">
			<section id="about" class="about section">
				<div class="container">
					<!-- Xizmatlar sariq chiziq ostidagi shuning dizayini -->
					<div class="menu-container mb-5 mt-4">
						<div class="menu-container::before"></div>
						<div class="menu-text">
							<h2><strong>Хизматлар</strong></h2>
						</div>
					</div>
					<hr class="mb-5" />
					<div class="row">
						<div class="col-lg-4">
							<div class="search_container">
								<form action="">
									<input type="text" class="search_box" placeholder="Қидириш" />
									<i class="fas fa-search"></i>
								</form>
							</div>

							<div class="filter-box mt-4">
								<div class="filter-title">Filtrlash</div>
								<div class="filter-body mx-2">
									<div class="filter-item" onclick="toggleFilters('regionFilters')"><i class="fas fa-globe"></i> Худудлар</div>
									<div id="regionFilters" class="filter-container">
										<input type="checkbox" class="region" value="Toshkent" /> Тошкент вилояти <br />
										<input type="checkbox" class="region" value="Samarkand" /> Самарқанд вилояти <br />
										<input type="checkbox" class="region" value="Buxoro" /> Бухоро вилояти <br />
										<input type="checkbox" class="region" value="Fargona" /> Фарғона вилояти <br />
										<input type="checkbox" class="region" value="Andijon" /> Андижон вилояти <br />
									</div>

									<div class="filter-item" onclick="toggleFilters('yearFilters')"><i class="fas fa-calendar"></i> Йиллар</div>
									<div id="yearFilters" class="filter-container">
										<input type="checkbox" class="year" value="2015" /> 2015 <br />
										<input type="checkbox" class="year" value="2016" /> 2016 <br />
										<input type="checkbox" class="year" value="2017" /> 2017 <br />
										<input type="checkbox" class="year" value="2018" /> 2018 <br />
										<input type="checkbox" class="year" value="2019" /> 2019 <br />
										<input type="checkbox" class="year" value="2020" /> 2020 <br />
										<input type="checkbox" class="year" value="2021" /> 2021 <br />
										<input type="checkbox" class="year" value="2022" /> 2022 <br />
										<input type="checkbox" class="year" value="2023" /> 2023 <br />
										<input type="checkbox" class="year" value="2024" /> 2024 <br />
									</div>

									<div class="filter-item" onclick="toggleFilters('seriesFilters')"><i class="fas fa-list"></i> Серия</div>
									<div id="seriesFilters" class="filter-container">
										<input type="checkbox" class="series" value="A" /> A <br />
										<input type="checkbox" class="series" value="B" /> B <br />
										<input type="checkbox" class="series" value="C" /> C <br />
									</div>
								</div>
							</div>
						</div>

						<div class="col-lg-8">
							<div class="container-fluid">
								<div class="d-flex button-container mb-3">
									<button class="btn btn-custom" onclick="setActive(this, 'section-table')"><i class="bi bi-grid"></i> Жадвал</button>
									<button class="btn btn-custom" onclick="setActive(this, 'section-chart')"><i class="bi bi-bar-chart"></i> График</button>
									<button class="btn btn-custom" onclick="setActive(this, 'section-report')"><i class="bi bi-info-circle"></i> Репорт</button>
									<div class="dropdown">
										<button class="btn btn-custom dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i> Юклаш</button>
										<ul class="dropdown-menu">
											<li><a class="dropdown-item" id="downloadExcelBtn" href="#">Excel</a></li>
											<li><a class="dropdown-item" id="downloadCSVBtn" href="#">CSV</a></li>
											<li><a class="dropdown-item" id="downloadTXTBtn" href="#">TXT</a></li>
											<!-- <button id="downloadExcelBtn" class="btn-custom">Excel yuklab olish</button>
											<button id="downloadCSVBtn" class="btn-custom">CSV yuklab olish</button>
											<button id="downloadTXTBtn" class="btn-custom">TXT yuklab olish</button> -->
										</ul>
									</div>
								</div>
							</div>
							<div class="main-container">
								<div id="section-default" class="content-section fw-bold">
								<h6 class="mb-4 mt-4" style="margin-left: -14%;color: rgb(105, 105, 105);">Ҳисоботни кўриш учун қуйидаги ўлчамларнинг ҳар биридан ўзгарувчиларни танланг. Сиз чап панелдан ёки юқоридаги ҳаволаларни босиш орқали танлашингиз мумкин.</h6>
									<ul>
										<li><i class="fas fa-square" style="font-size: 10px; margin-right: 5px;"></i>Худудлар</li>
										<li><i class="fas fa-square" style="font-size: 10px; margin-right: 5px;"></i>Йиллар</li>
										<li><i class="fas fa-square" style="font-size: 10px; margin-right: 5px;"></i>Серия</li>
									</ul>
								</div>
								<div id="section-table" class="content-section" style="display: none;">
									<h5>Жадвал</h5>
									<table id="dataTable" class="display" style="width:100%">
										<thead>
											<tr>
												<th>Худуд</th>
												<th>Йил</th>
												<th>Серия</th>
												<th>Қиймат</th>
											</tr>
										</thead>
										<tbody></tbody>
									</table>
								</div>

								<div id="section-chart" class="content-section" style="display: none;">
									<h5>График</h5>
									<canvas id="chartCanvas"></canvas>
								</div>

								<div id="section-report" class="content-section" style="display: none;">
									<h5>Репорт</h5>
									<p>Бу ерда репорт маълумотлари чиқади.</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</main>

		<footer id="footer" class="footer light-background">
			<div class="container footer-top gy-4">
				<h5 class="underline-title">
					Ўзбекистон Республикаси Вазирлар Маҳкамаси Ҳузурида Макроиқтисодий ва ҳудудий тадқиқотлар институти
				</h5>
				<div class="email-container text-center mt-5">
					<form action="">
						<input type="text" class="email-box text-white" placeholder="Эмаилни киритинг" />
					</form>
				</div>
				<div class="footer-div mt-5">
					<div class="line"></div>
					<a href="https://t.me/support" class="support"> <i class="fab fa-telegram-plane"></i> Телеграм </a>
					<div class="line"></div>
				</div>
			</div>
		</footer>
		<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
		<script>
			let table;
let chart;
let filteredData = []; // 🔥 Filtrlashdan o'tgan ma'lumotlarni saqlash

$(document).ready(function () {
    // DataTable yaratish
    table = $('#dataTable').DataTable();

    // Filterlarni kuzatish
    $('.region, .year, .series').change(filterData);

    // Boshlang'ich filterni tekshirish
    filterData();

    // 🔗 Tugmalarni funksiya bilan bog'lash
    $('#downloadExcelBtn').on('click', downloadExcel);
    $('#downloadCSVBtn').on('click', downloadCSV);
    $('#downloadTXTBtn').on('click', downloadTXT);
});
function toggleFilters(filterId) {
    $('#' + filterId).slideToggle();
}
// 🔹 Grafikni yangilash
function updateChart(data) {
    if (chart) chart.destroy();

    let ctx = document.getElementById('chartCanvas').getContext('2d');
    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data.map(d => d.year),
            datasets: [{
                label: 'Қиймат',
                data: data.map(d => d.value),
                backgroundColor: 'rgba(54, 162, 235, 0.6)'
            }]
        }
    });
}
function setActive(button, section) {
    // Barcha content sectionlarini yashirish
    const sections = document.querySelectorAll('.content-section');
    sections.forEach(s => s.style.display = 'none');

    // Tanlangan bo'limni ko'rsatish
    document.getElementById(section).style.display = 'block';

    // Tugmalardan "active" klassini o'chirish
    const buttons = document.querySelectorAll('.btn-custom');
    buttons.forEach(b => b.classList.remove('active'));

    // Tanlangan tugmaga "active" klassini qo'shish
    button.classList.add('active');
}
// 🔹 Dummy ma'lumotlar
let dummyData = [
    { region: 'Toshkent', year: '2023', series: 'A', value: 100 },
    { region: 'Samarkand', year: '2023', series: 'B', value: 150 },
    { region: 'Toshkent', year: '2024', series: 'A', value: 200 },
    { region: 'Samarkand', year: '2024', series: 'B', value: 250 },
    { region: 'Buxoro', year: '2024', series: 'A', value: 220 },
    { region: 'Buxoro', year: '2024', series: 'B', value: 270 },
    { region: 'Buxoro', year: '2023', series: 'A', value: 220 },
    { region: 'Buxoro', year: '2023', series: 'B', value: 270 },
    { region: 'Fargona', year: '2023', series: 'A', value: 150 },
    { region: 'Fargona', year: '2023', series: 'B', value: 180 },
    { region: 'Fargona', year: '2023', series: 'C', value: 140 },
    { region: 'Andijon', year: '2019', series: 'A', value: 160 }
];

// 🔹 Filter bo‘yicha ma’lumotlarni yangilash
function filterData() {
    let selectedRegions = $('.region:checked').map(function () { return this.value; }).get();
    let selectedYears = $('.year:checked').map(function () { return this.value; }).get();
    let selectedSeries = $('.series:checked').map(function () { return this.value; }).get();

    // 🔹 Tanlangan filterlar bo‘yicha saralash
    filteredData = dummyData.filter(item =>
        selectedRegions.includes(item.region) &&
        selectedYears.includes(item.year) &&
        selectedSeries.includes(item.series)
    );

    // 🔹 Jadvalni yangilash
    table.clear().rows.add(filteredData.map(d => [d.region, d.year, d.series, d.value])).draw();

    // 🔹 Grafikni yangilash
    updateChart(filteredData);
}

// 🔸 Excel yuklab olish funksiyasi
function downloadExcel() {
    if (filteredData.length === 0) {
        alert("Ma'lumot topilmadi!");
        return;
    }

    const ws = XLSX.utils.json_to_sheet(filteredData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Data");
    XLSX.writeFile(wb, "data.xlsx");
}

// 🔸 CSV yuklab olish funksiyasi
function downloadCSV() {
    if (filteredData.length === 0) {
        alert("Ma'lumot topilmadi!");
        return;
    }

    let csvContent = "data:text/csv;charset=utf-8,";
    csvContent += "Region,Year,Series,Value\n";
    filteredData.forEach(row => {
        csvContent += `${row.region},${row.year},${row.series},${row.value}\n`;
    });

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "data.csv");
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// 🔸 TXT yuklab olish funksiyasi
function downloadTXT() {
    if (filteredData.length === 0) {
        alert("Ma'lumot topilmadi!");
        return;
    }

    let txtContent = "";
    filteredData.forEach(row => {
        txtContent += `Region: ${row.region}, Year: ${row.year}, Series: ${row.series}, Value: ${row.value}\n`;
    });

    const blob = new Blob([txtContent], { type: "text/plain" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "data.txt";
    link.click();
}

		</script>
		<script src="assets/js/main.js"></script>
		<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="assets/vendor/php-email-form/validate.js"></script>
		<script src="assets/vendor/aos/aos.js"></script>
		<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
		<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
		<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
		<script src="assets/vendor/imagesloaded/imagesloaded.pkgd.min.js"></script>
		<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
		
		<!-- <script src="assets/js/script.js"></script> -->
		<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
	</body>
</html>
